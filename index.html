<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>tag demo</title>
    <script src="https://unpkg.com/react/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone/babel.min.js"></script>
    <style>
      body {
        font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
      }
      hr {
        margin: 20px 0;
      }
      select {
        margin: 10px 0;
      }

      h1 {
        font-size: 2em;
        margin: 0;
      }

      h2 {
        font-size: 1em;
        font-weight: 500;
        color: #0366d6;
        margin: 5px;
      }

      .tag-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .tag {
        padding: 5px 10px;
        border: 1px solid #000;
        border-radius: 5px;
        cursor: pointer;
      }
      .tag.active {
        background-color: #000;
        color: #fff;
      }

      .item-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .item {
        padding: 5px 10px;
        border: 1px solid #000;
        border-radius: 15px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      function TagDemo(props) {
        const tags = []
        props.items.forEach((item) => {
          item.tags.forEach((tag) => {
            if (!tags.includes(tag)) {
              tags.push(tag)
            }
          })
        })

        const [activeTags, setActiveTags] = React.useState([])
        const [chosenItems, setChosenItems] = React.useState([])
        const [mode, setMode] = React.useState("and")
        // const TagContext = React.createContext(null)

        React.useEffect(() => {
          if (mode === "and") {
            setChosenItems(
              props.items.filter((item) => {
                return activeTags.every((tag) => item.tags.includes(tag))
              })
            )
          } else if (mode === "or") {
            setChosenItems(
              props.items.filter((item) => {
                return activeTags.some((tag) => item.tags.includes(tag))
              })
            )
          }
        }, [activeTags, mode])

        return (
          <div>
            <h1>Tag Demo</h1>
            <div>
              <TagsContainer tags={tags} activeTags={activeTags} setActiveTags={setActiveTags} />
              <ModeSelector modes={["and", "or"]} setMode={setMode} />
              <hr />
              <ItemsContainer items={chosenItems} />
            </div>
          </div>
        )
      }

      function ModeSelector(props) {
        return (
          <select onChange={(e) => props.setMode(e.target.value)}>
            {props.modes.map((mode) => (
              <option key={mode} value={mode}>
                {mode}
              </option>
            ))}
          </select>
        )
      }

      function TagsContainer(props) {
        return (
          <div>
            <h2>tags(click to chose):</h2>
            <div className="tag-container">
              {props.tags.map((tag) => (
                <Tag key={tag} tag={tag} activeTags={props.activeTags} setActiveTags={props.setActiveTags} />
              ))}
            </div>
          </div>
        )
      }

      function ItemsContainer(props) {
        return (
          <div>
            <h2>items:</h2>
            <div className="item-container">
              {props.items.map((item) => (
                <Item key={item.name} item={item} />
              ))}
            </div>
          </div>
        )
      }

      function Tag(props) {
        const isActive = props.activeTags.includes(props.tag)
        const className = isActive ? "tag active" : "tag"
        return (
          <div
            className={className}
            onClick={() => {
              if (props.activeTags.includes(props.tag)) {
                props.setActiveTags(props.activeTags.filter((tag) => tag !== props.tag))
              } else {
                props.setActiveTags([...props.activeTags, props.tag])
              }
            }}
          >
            {props.tag}
          </div>
        )
      }

      function Item(props) {
        return <div className="item">{props.item.name}</div>
      }

      const items = [
        { name: "apple", tags: ["red", "sweet", "round", "fruit", "hard"] },
        { name: "orange", tags: ["orange", "sweet", "round", "fruit", "hard"] },
        { name: "banana", tags: ["yellow", "sweet", "round", "fruit", "soft"] },
        { name: "grapes", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "mango", tags: ["yellow", "sweet", "round", "fruit", "soft"] },
        { name: "pineapple", tags: ["yellow", "sweet", "round", "fruit", "soft"] },
        { name: "watermelon", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "papaya", tags: ["yellow", "sweet", "round", "fruit", "soft"] },
        { name: "strawberry", tags: ["red", "sweet", "round", "fruit", "soft"] },
        { name: "cherry", tags: ["red", "sweet", "round", "fruit", "soft"] },
        { name: "pomegranate", tags: ["red", "sweet", "round", "fruit", "hard"] },
        { name: "guava", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "jackfruit", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "kiwi", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "lemon", tags: ["yellow", "sour", "round", "fruit", "hard"] },
        { name: "lime", tags: ["green", "sour", "round", "fruit", "hard"] },
        { name: "coconut", tags: ["brown", "sweet", "round", "fruit", "hard"] },
        { name: "avocado", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "peach", tags: ["orange", "sweet", "round", "fruit", "soft"] },
        { name: "pear", tags: ["green", "sweet", "round", "fruit", "soft"] },
        { name: "plum", tags: ["purple", "sweet", "round", "fruit", "soft"] },
      ]
      ReactDOM.createRoot(document.getElementById("root")).render(<TagDemo items={items} />)
    </script>
  </body>
</html>
